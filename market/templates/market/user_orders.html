{% extends 'market/base.html' %}
{% load static %}
{% load market_filters %}

{% block title %}我的订单 - 特色时令产品集市平台{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/cart.css' %}">
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">我的订单</h1>
    <p class="page-description">查看和管理您的订单记录</p>
</div>

{% if orders.exists %}
    <div class="orders-container">
        <div class="orders-table-wrapper">
            <table class="orders-table">
                <thead>
                    <tr>
                        <th>产品图片</th>
                        <th>订单编号</th>
                        <th>总金额</th>
                        <th>状态</th>
                        <th>订单时间</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in orders %}
                        <tr>
                            <td class="order-item-image">
                                {% if order.first_item_specialty %}
                                    <img src="{{ order.first_item_specialty|product_image }}" alt="{{ order.first_item_name }}" class="order-item-thumbnail">
                                {% else %}
                                    <img src="{% static 'images/default-product.svg' %}" alt="{{ order.first_item_name }}" class="order-item-thumbnail">
                                {% endif %}
                            </td>
                            <td class="order-id">{{ order.order_id }}</td>
                            <td class="order-amount">¥{{ order.total_amount }}</td>
                            <td>
                                <span class="order-status status-{{ order.status }}">{{ order.status }}</span>
                            </td>
                            <td class="order-time">{{ order.order_time }}</td>
                            <td>
                                <div class="order-actions">
                                    <a href="{% url 'order_detail' order.order_id %}" class="btn btn-outline btn-sm">查看详情</a>
                                    {% if order.status == '待支付' %}
                                        <a href="{% url 'pay_order' order.order_id %}" class="btn btn-primary btn-sm">支付</a>
                                    {% endif %}
                                    {% if order.status in '已支付' or order.status == '已完成' %}
                                        <a href="{% url 'submit_complaint' order.order_id %}" class="btn btn-danger btn-sm">投诉</a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% else %}
    <div class="empty-orders">
        <div class="empty-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
        </div>
        <h3>您还没有任何订单</h3>
        <p>快去选择您喜欢的特色产品吧</p>
        <a href="{% url 'index' %}" class="btn btn-primary">去购物</a>
    </div>
{% endif %}
{% endblock %}